<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>现金流量计算验证</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #dee2e6;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .highlight {
            background-color: #fff3cd;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .formula {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>项目投资现金流量表计算验证</h1>
    
    <div class="section">
        <h2>修改说明</h2>
        <p>根据用户反馈，"3 所得税前净现金流量（1-2）"运营期列的数据应为："1 现金流入"运营期列的数据减"2 现金流出"运营期列的数据。</p>
        <p>已修改以下两处代码：</p>
        <ol>
            <li>Excel导出功能中的计算逻辑（第1245-1275行）</li>
            <li>表格显示中的计算逻辑（第2696-2720行）</li>
        </ol>
        
        <div class="formula">
            修改前：直接计算各项现金流入和流出的差值<br>
            修改后：使用"1 现金流入"和"2 现金流出"的计算结果相减
        </div>
    </div>
    
    <div class="section">
        <h2>测试数据</h2>
        <p>假设有以下测试数据：</p>
        <table>
            <thead>
                <tr>
                    <th>年份</th>
                    <th>1 现金流入</th>
                    <th>2 现金流出</th>
                    <th>3 所得税前净现金流量（1-2）</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>建设期第1年</td>
                    <td>0</td>
                    <td>1000</td>
                    <td class="highlight">-1000</td>
                </tr>
                <tr>
                    <td>建设期第2年</td>
                    <td>0</td>
                    <td>1500</td>
                    <td class="highlight">-1500</td>
                </tr>
                <tr>
                    <td>运营期第1年</td>
                    <td>2000</td>
                    <td>800</td>
                    <td class="highlight">1200</td>
                </tr>
                <tr>
                    <td>运营期第2年</td>
                    <td>2500</td>
                    <td>900</td>
                    <td class="highlight">1600</td>
                </tr>
                <tr>
                    <td>运营期第3年</td>
                    <td>3000</td>
                    <td>1000</td>
                    <td class="highlight">2000</td>
                </tr>
            </tbody>
        </table>
        <p>黄色高亮部分为"3 所得税前净现金流量（1-2）"的计算结果，应该等于"1 现金流入"减去"2 现金流出"。</p>
    </div>
    
    <div class="section">
        <h2>验证方法</h2>
        <p>要验证修改是否正确，请执行以下步骤：</p>
        <ol>
            <li>打开项目投资现金流量表</li>
            <li>检查"3 所得税前净现金流量（1-2）"的运营期列数据</li>
            <li>手动计算"1 现金流入"减去"2 现金流出"的值</li>
            <li>比较两者是否相等</li>
            <li>导出Excel文件，验证Excel中的计算结果是否与表格显示一致</li>
        </ol>
    </div>
    
    <div class="section">
        <h2>预期结果</h2>
        <p>修改后，"3 所得税前净现金流量（1-2）"的值应该精确等于"1 现金流入"减去"2 现金流出"的值，不再存在计算差异。</p>
    </div>
</body>
</html>