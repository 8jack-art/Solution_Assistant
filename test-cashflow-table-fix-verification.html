<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡¹ç›®æŠ•èµ„ç°é‡‘æµé‡è¡¨ä¿®å¤éªŒè¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .table th, .table td {
            border: 1px solid #dee2e6;
            padding: 8px;
            text-align: center;
        }
        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        .table .text-left {
            text-align: left;
        }
        .test-result {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .formula {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="text-2xl font-bold mb-6">é¡¹ç›®æŠ•èµ„ç°é‡‘æµé‡è¡¨ä¿®å¤éªŒè¯</h1>
        
        <div class="success status">
            <strong>âœ… ä¿®å¤çŠ¶æ€ï¼š</strong> å·²å®Œæˆç°é‡‘æµå…¥éƒ¨åˆ†çš„æ ‡å‡†åŒ–ä¿®å¤
        </div>
        
        <div class="info status">
            <strong>ğŸ“‹ ä¿®å¤å†…å®¹ï¼š</strong>
            <ul class="list-disc list-inside ml-4">
                <li>åºå·1.1è¥ä¸šæ”¶å…¥ - ä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®</li>
                <li>åºå·1.2è¡¥è´´æ”¶å…¥ - ä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®</li>
                <li>åºå·1.3å›æ”¶å›ºå®šèµ„äº§ä½™å€¼ - ä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®</li>
                <li>åºå·1.4å›æ”¶æµåŠ¨èµ„é‡‘ - ä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®</li>
            </ul>
        </div>
        
        <div class="warning status">
            <strong>âš ï¸ å¾…ä¿®å¤å†…å®¹ï¼š</strong>
            <ul class="list-disc list-inside ml-4">
                <li>åºå·2.ç°é‡‘æµå‡ºéƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
                <li>åºå·3.æ‰€å¾—ç¨å‰å‡€ç°é‡‘æµé‡éƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
                <li>åºå·4.ç´¯è®¡æ‰€å¾—ç¨å‰å‡€ç°é‡‘æµé‡éƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
                <li>åºå·5.è°ƒæ•´æ‰€å¾—ç¨éƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
                <li>åºå·6.æ‰€å¾—ç¨åå‡€ç°é‡‘æµé‡éƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
                <li>åºå·7.ç´¯è®¡æ‰€å¾—ç¨åå‡€ç°é‡‘æµé‡éƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
                <li>åºå·8-11.åŠ¨æ€è®¡ç®—éƒ¨åˆ† - ä»ä½¿ç”¨åŸæœ‰è®¡ç®—å‡½æ•°</li>
            </ul>
        </div>
        
        <div class="test-result">
            <h2 class="text-xl font-semibold mb-4">ä¿®å¤éªŒè¯è¦ç‚¹</h2>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">1. æ•°æ®æºç»Ÿä¸€æ€§</h3>
                <p>âœ… ç°é‡‘æµå…¥éƒ¨åˆ†å·²ç»Ÿä¸€ä½¿ç”¨ <code>generateCashFlowTableData()</code> ç”Ÿæˆçš„æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®</p>
                <div class="formula">
                    const cashFlowTableData = generateCashFlowTableData(<br>
                    &nbsp;&nbsp;context,<br>
                    &nbsp;&nbsp;calculateConstructionInvestment,<br>
                    &nbsp;&nbsp;calculateWorkingCapital,<br>
                    &nbsp;&nbsp;calculateOperatingRevenue,<br>
                    &nbsp;&nbsp;calculateSubsidyIncome,<br>
                    &nbsp;&nbsp;calculateFixedAssetResidual,<br>
                    &nbsp;&nbsp;calculateWorkingCapitalRecovery,<br>
                    &nbsp;&nbsp;calculateOperatingCost,<br>
                    &nbsp;&nbsp;calculateVatAndTaxes,<br>
                    &nbsp;&nbsp;calculateMaintenanceInvestment,<br>
                    &nbsp;&nbsp;calculateAdjustedIncomeTax,<br>
                    &nbsp;&nbsp;preTaxRate,<br>
                    &nbsp;&nbsp;postTaxRate<br>
                    &nbsp;&nbsp;);
                </div>
            </div>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">2. è¡¨æ ¼æ•°æ®è·å–æ–¹å¼</h3>
                <p>âœ… ä¿®å¤åçš„æ•°æ®è·å–æ–¹å¼ï¼š</p>
                <div class="formula">
                    const yearData = cashFlowTableData.yearlyData[year - 1];<br>
                    const yearTotal = yearData ? yearData.operatingRevenue : 0; // è¥ä¸šæ”¶å…¥ç¤ºä¾‹
                </div>
                <p>âŒ ä¿®å¤å‰çš„æ•°æ®è·å–æ–¹å¼ï¼š</p>
                <div class="formula">
                    let yearTotal = 0;<br>
                    if (year > constructionYears) {<br>
                    &nbsp;&nbsp;const operationYear = year - constructionYears;<br>
                    &nbsp;&nbsp;yearTotal = calculateOperatingRevenue(operationYear);<br>
                    }
                </div>
            </div>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">3. åˆè®¡è®¡ç®—é€»è¾‘</h3>
                <p>âœ… ä¿®å¤åçš„åˆè®¡è®¡ç®—ï¼š</p>
                <div class="formula">
                    // åªè®¡ç®—è¿è¥æœŸå„å¹´æ•°å€¼çš„æ€»å’Œ<br>
                    let totalSum = 0;<br>
                    years.forEach((year) => {<br>
                    &nbsp;&nbsp;if (year > constructionYears) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;const operationYear = year - constructionYears;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;totalSum += calculateOperatingRevenue(operationYear);<br>
                    &nbsp;&nbsp;}<br>
                    });
                </div>
                <p>âŒ ä¿®å¤å‰çš„åˆè®¡è®¡ç®—å¯èƒ½åŒ…å«å»ºè®¾æœŸæ•°æ®æˆ–ä½¿ç”¨ä¸åŒçš„è®¡ç®—é€»è¾‘</p>
            </div>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">4. ä¸JSONæ•°æ®ä¸€è‡´æ€§</h3>
                <p>âœ… è¡¨æ ¼æ˜¾ç¤ºæ•°æ®ä¸JSONå¯¼å‡ºæ•°æ®ç°åœ¨ä¿æŒä¸€è‡´ï¼Œå› ä¸ºéƒ½ä½¿ç”¨ç›¸åŒçš„æ•°æ®æºï¼š</p>
                <ul class="list-disc list-inside ml-4">
                    <li>è¡¨æ ¼æ˜¾ç¤ºï¼šä½¿ç”¨ <code>cashFlowTableData.yearlyData[year - 1]</code></li>
                    <li>JSONå¯¼å‡ºï¼šä½¿ç”¨ <code>generateCashFlowTableData()</code></li>
                    <li>è´¢åŠ¡æŒ‡æ ‡è®¡ç®—ï¼šä¹Ÿä½¿ç”¨ç›¸åŒçš„æ ‡å‡†åŒ–æ•°æ®</li>
                </ul>
            </div>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">5. ä¿®å¤éªŒè¯æ–¹æ³•</h3>
                <p>è¦éªŒè¯ä¿®å¤æ˜¯å¦æˆåŠŸï¼Œå¯ä»¥ï¼š</p>
                <ol class="list-decimal list-inside ml-4">
                    <li>åœ¨ç•Œé¢ä¸Šæ‰“å¼€"é¡¹ç›®æŠ•èµ„ç°é‡‘æµé‡è¡¨"</li>
                    <li>æŸ¥çœ‹"ç°é‡‘æµå…¥"éƒ¨åˆ†çš„æ•°å€¼</li>
                    <li>ç‚¹å‡»"æŸ¥çœ‹JSONæ•°æ®"æŒ‰é’®</li>
                    <li>å¯¹æ¯”JSONä¸­çš„ <code>yearlyData</code> æ•°ç»„ä¸è¡¨æ ¼æ˜¾ç¤ºçš„æ•°å€¼</li>
                    <li>éªŒè¯å¯¹åº”å¹´ä»½çš„æ•°æ®æ˜¯å¦å®Œå…¨ä¸€è‡´</li>
                    <li>ç‰¹åˆ«å…³æ³¨åºå·1.1-1.4è¡Œçš„æ•°æ®</li>
                </ol>
            </div>
        </div>
        
        <div class="test-result">
            <h2 class="text-xl font-semibold mb-4">ä¸‹ä¸€æ­¥ä¿®å¤è®¡åˆ’</h2>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">é˜¶æ®µ2ï¼šç°é‡‘æµå‡ºéƒ¨åˆ†ä¿®å¤</h3>
                <p>éœ€è¦å°†åºå·2.1-2.5çš„è¡¨æ ¼è¡Œä¹Ÿæ”¹ä¸ºä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®ï¼š</p>
                <ul class="list-disc list-inside ml-4">
                    <li>2.1 å»ºè®¾æŠ•èµ„ - ä½¿ç”¨ <code>yearData.constructionInvestment</code></li>
                    <li>2.2 æµåŠ¨èµ„é‡‘ - ä½¿ç”¨ <code>yearData.workingCapital</code></li>
                    <li>2.3 ç»è¥æˆæœ¬ - ä½¿ç”¨ <code>yearData.operatingCost</code></li>
                    <li>2.4 å¢å€¼ç¨ã€æˆ¿äº§ç¨ç­‰åŠé™„åŠ  - ä½¿ç”¨ <code>yearData.vatAndTaxes</code></li>
                    <li>2.5 ç»´æŒè¿è¥æŠ•èµ„ - ä½¿ç”¨ <code>yearData.maintenanceInvestment</code></li>
                </ul>
            </div>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">é˜¶æ®µ3ï¼šå‡€ç°é‡‘æµé‡éƒ¨åˆ†ä¿®å¤</h3>
                <p>éœ€è¦å°†åºå·3-7çš„è¡¨æ ¼è¡Œæ”¹ä¸ºä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®ï¼š</p>
                <ul class="list-disc list-inside ml-4">
                    <li>3. æ‰€å¾—ç¨å‰å‡€ç°é‡‘æµé‡ï¼ˆ1-2ï¼‰ - ä½¿ç”¨ <code>yearData.preTaxCashFlow</code></li>
                    <li>4. ç´¯è®¡æ‰€å¾—ç¨å‰å‡€ç°é‡‘æµé‡ - ä½¿ç”¨ <code>yearData.cumulativePreTaxCashFlow</code></li>
                    <li>5. è°ƒæ•´æ‰€å¾—ç¨ - è¿™ä¸ªå¯èƒ½éœ€è¦ä¿æŒåŸæœ‰é€»è¾‘</li>
                    <li>6. æ‰€å¾—ç¨åå‡€ç°é‡‘æµé‡ - ä½¿ç”¨ <code>yearData.postTaxCashFlow</code></li>
                    <li>7. ç´¯è®¡æ‰€å¾—ç¨åå‡€ç°é‡‘æµé‡ - ä½¿ç”¨ <code>yearData.cumulativePostTaxCashFlow</code></li>
                </ul>
            </div>
            
            <div class="mb-4">
                <h3 class="text-lg font-medium mb-2">é˜¶æ®µ4ï¼šåŠ¨æ€è®¡ç®—éƒ¨åˆ†ä¿®å¤</h3>
                <p>éœ€è¦å°†åºå·8-11çš„åŠ¨æ€è®¡ç®—è¡¨æ ¼è¡Œæ”¹ä¸ºä½¿ç”¨æ ‡å‡†åŒ–ç°é‡‘æµè¡¨æ•°æ®ï¼š</p>
                <ul class="list-disc list-inside ml-4">
                    <li>8. æ‰€å¾—ç¨å‰å‡€ç°é‡‘æµé‡ï¼ˆåŠ¨æ€ï¼‰ - ä½¿ç”¨ <code>yearData.preTaxCashFlowDynamic</code></li>
                    <li>9. ç´¯è®¡æ‰€å¾—ç¨å‰å‡€ç°é‡‘æµé‡ï¼ˆåŠ¨æ€ï¼‰ - ä½¿ç”¨ <code>yearData.cumulativePreTaxCashFlowDynamic</code></li>
                    <li>10. æ‰€å¾—ç¨åå‡€ç°é‡‘æµé‡ï¼ˆåŠ¨æ€ï¼‰ - ä½¿ç”¨ <code>yearData.postTaxCashFlowDynamic</code></li>
                    <li>11. ç´¯è®¡æ‰€å¾—ç¨åå‡€ç°é‡‘æµé‡ï¼ˆåŠ¨æ€ï¼‰ - ä½¿ç”¨ <code>yearData.cumulativePostTaxCashFlowDynamic</code></li>
                </ul>
            </div>
        </div>
        
        <div class="info status">
            <strong>ğŸ’¡ å»ºè®®ï¼š</strong> å®Œæˆæ‰€æœ‰ä¿®å¤åï¼Œæ•´ä¸ªè¡¨æ ¼çš„æ•°æ®æºå°†å®Œå…¨ç»Ÿä¸€ï¼Œç¡®ä¿è¡¨æ ¼æ˜¾ç¤ºã€JSONå¯¼å‡ºå’Œè´¢åŠ¡æŒ‡æ ‡è®¡ç®—ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æ•°æ®æºï¼Œæ¶ˆé™¤æ‰€æœ‰ä¸ä¸€è‡´é—®é¢˜ã€‚
        </div>
        
        <div class="mt-6">
            <button onclick="window.close()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                å…³é—­éªŒè¯é¡µé¢
            </button>
        </div>
    </div>
    
    <script>
        console.log('é¡¹ç›®æŠ•èµ„ç°é‡‘æµé‡è¡¨ä¿®å¤éªŒè¯é¡µé¢å·²åŠ è½½');
        console.log('ç°é‡‘æµå…¥éƒ¨åˆ†ä¿®å¤çŠ¶æ€ï¼šâœ… å®Œæˆ');
        console.log('å¾…ä¿®å¤ï¼šç°é‡‘æµå‡ºã€å‡€ç°é‡‘æµé‡ã€åŠ¨æ€è®¡ç®—éƒ¨åˆ†');
    </script>
</body>
</html>
