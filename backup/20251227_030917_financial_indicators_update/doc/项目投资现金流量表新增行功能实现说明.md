# 项目投资现金流量表新增行功能实现说明

## 修改背景

根据用户需求，需要在项目投资现金流量表modal中增加5行新内容，包括1个空行和4行动态计算的净现金流量数据。

## 修改内容

### 1. 修改文件
- 文件路径：`client/src/components/revenue-cost/FinancialIndicatorsTable.tsx`
- 修改函数：`renderProfitTaxModal`（第1922行开始）

### 2. 新增内容
在表格末尾添加了以下5行：

#### 第1行：空行
- 设置边框颜色为透明（`border: 'transparent'`）
- 设置高度为20px
- 跨所有列（`colSpan={3 + totalYears}`）

#### 第2行：所得税前净现金流量（动态）
- 序号：1
- 项目名称：所得税前净现金流量（动态）
- 计算逻辑：现金流入合计 - 现金流出合计
- 数据来源：动态计算各年数据

#### 第3行：累计所得税前净现金流量（动态）
- 序号：2
- 项目名称：累计所得税前净现金流量（动态）
- 计算逻辑：累计各年所得税前净现金流量
- 数据来源：动态计算各年累计值

#### 第4行：所得税后净现金流量（动态）
- 序号：3
- 项目名称：所得税后净现金流量（动态）
- 计算逻辑：现金流入合计 - 现金流出合计 - 调整所得税合计
- 数据来源：动态计算各年数据

#### 第5行：累计所得税后净现金流量（动态）
- 序号：4
- 项目名称：累计所得税后净现金流量（动态）
- 计算逻辑：累计各年所得税后净现金流量
- 数据来源：动态计算各年累计值

## 技术实现

### 1. 空行实现
```jsx
{/* 新增的空行，边框颜色透明 */}
<Table.Tr>
  <Table.Td style={{ border: 'transparent', height: '20px' }} colSpan={3 + totalYears}></Table.Td>
</Table.Tr>
```

### 2. 动态计算行实现
每行动态计算行都包含以下结构：
1. 合计列的计算：使用立即执行函数计算所有年份的合计值
2. 各年数据的计算：使用`map`函数遍历各年，计算每年的值
3. 使用`formatNumberNoRounding`和`formatNumberWithZeroBlank`函数格式化显示

### 3. 计算逻辑
所有新增行的计算逻辑与原有行保持一致，确保数据的准确性和一致性：
- 建设期：只有现金流出（建设投资+流动资金）
- 运营期：现金流入（营业收入+补贴收入+回收固定资产余值+回收流动资金）- 现金流出（建设投资+流动资金+经营成本+增值税等+维持运营投资）
- 所得税后计算：在所得税前的基础上减去调整所得税

## 修改影响

1. **界面影响**：项目投资现金流量表增加了5行新内容，增强了表格的完整性和可读性
2. **功能影响**：新增的动态计算行提供了更全面的财务分析视角
3. **性能影响**：新增的计算逻辑对性能影响极小，因为计算量较小

## 测试建议

1. 验证新增行是否正确显示
2. 检查动态计算的数据是否准确
3. 确认空行的边框是否为透明
4. 测试不同项目配置下的数据计算
5. 验证Excel导出功能是否包含新增行

## 注意事项

1. 新增行的计算逻辑与原有行保持一致，确保数据一致性
2. 空行的边框设置为透明，符合用户需求
3. 所有新增行都使用了相同的样式，保持界面一致性
4. 计算逻辑考虑了建设期和运营期的不同情况